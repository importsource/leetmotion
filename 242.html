<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeetMotion - Valid Anagram (LC 242)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        code, pre { font-family: 'Fira Code', monospace; }
        
        /* Smooth transitions for visualization elements */
        .vis-box { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .highlight-line { background-color: rgba(253, 224, 71, 0.2); border-left: 4px solid #FACC15; }
        .highlight-current { border-color: #3B82F6; background-color: #EFF6FF; transform: scale(1.1); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .highlight-match { background-color: #D1FAE5; border-color: #10B981; }
        .highlight-error { background-color: #FEE2E2; border-color: #EF4444; }
        
        /* Custom scrollbar for code block */
        .custom-scroll::-webkit-scrollbar { width: 8px; height: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #1e1e1e; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #6b7280; }

        .count-bar-container { height: 80px; display: flex; align-items: flex-end; justify-content: center; }
        .count-bar { transition: height 0.3s ease, background-color 0.3s ease; width: 100%; border-radius: 4px 4px 0 0; }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col overflow-hidden">

    <!-- Navigation -->
    <nav class="border-b border-gray-800 bg-gray-900/50 backdrop-blur-md z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-bold text-white shadow-lg shadow-blue-500/30">L</div>
                    <span class="font-bold text-xl tracking-tight">LeetMotion <span class="text-blue-500 font-normal text-sm ml-1">242. Valid Anagram</span></span>
                </div>
                <a href="https://importsource.github.io/leetmotion/" target="_blank" class="text-gray-400 hover:text-white transition-colors flex items-center gap-2 text-sm font-medium px-4 py-2 rounded-md hover:bg-gray-800">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Home
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col lg:flex-row overflow-hidden">
        
        <!-- Left Panel: Visualization & Controls -->
        <div class="flex-1 flex flex-col border-r border-gray-800 overflow-y-auto custom-scroll relative bg-gray-900">
            
            <!-- Controls Area -->
            <div class="p-6 border-b border-gray-800 bg-gray-800/30">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">String S</label>
                        <input type="text" id="inputS" value="anagram" class="w-full bg-gray-800 border border-gray-700 text-white rounded px-3 py-2 focus:outline-none focus:border-blue-500 font-mono tracking-widest" placeholder="e.g. anagram">
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">String T</label>
                        <input type="text" id="inputT" value="nagaram" class="w-full bg-gray-800 border border-gray-700 text-white rounded px-3 py-2 focus:outline-none focus:border-blue-500 font-mono tracking-widest" placeholder="e.g. nagaram">
                    </div>
                </div>
                
                <div class="flex flex-wrap items-center gap-4">
                    <button id="btnStart" onclick="startVisualization()" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-md font-medium shadow-lg shadow-blue-600/20 transition-all flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                        </svg>
                        Run
                    </button>
                    <button id="btnReset" onclick="resetVisualization()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-md font-medium transition-all" disabled>
                        Reset
                    </button>
                    
                    <div class="flex-1 flex items-center gap-3 bg-gray-800 rounded-md px-4 py-2 border border-gray-700">
                        <span class="text-xs text-gray-400 font-mono">SPEED</span>
                        <input type="range" id="speedRange" min="1" max="100" value="50" class="flex-1 h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-blue-500">
                    </div>

                    <div id="statusBadge" class="hidden px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide"></div>
                </div>
                <p id="statusText" class="mt-4 text-sm text-gray-400 font-mono h-5">Ready to start...</p>
            </div>

            <!-- Visualization Canvas -->
            <div class="flex-1 p-6 flex flex-col justify-start space-y-12 overflow-y-auto">
                
                <!-- Strings Visualization -->
                <div class="flex flex-col gap-8 justify-center">
                    <!-- String S -->
                    <div>
                        <div class="flex justify-between items-end mb-2">
                            <span class="text-xs font-bold text-gray-500 uppercase">String s</span>
                            <span id="pointerS" class="text-xs font-mono text-blue-400 opacity-0 transition-opacity">i = <span id="valI">0</span></span>
                        </div>
                        <div id="containerS" class="flex flex-wrap gap-2"></div>
                    </div>

                    <!-- String T -->
                    <div>
                        <div class="flex justify-between items-end mb-2">
                            <span class="text-xs font-bold text-gray-500 uppercase">String t</span>
                            <span id="pointerT" class="text-xs font-mono text-purple-400 opacity-0 transition-opacity">i = <span id="valJ">0</span></span>
                        </div>
                        <div id="containerT" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>

                <!-- Frequency Array Visualization -->
                <div class="bg-gray-800/50 rounded-xl p-6 border border-gray-700">
                    <div class="flex justify-between items-center mb-6">
                        <span class="text-sm font-bold text-gray-300 uppercase tracking-wider">Frequency Array (Size 26)</span>
                        <div class="flex gap-4 text-xs">
                            <div class="flex items-center gap-1"><div class="w-3 h-3 bg-blue-500 rounded-sm"></div> +1 (From S)</div>
                            <div class="flex items-center gap-1"><div class="w-3 h-3 bg-purple-500 rounded-sm"></div> -1 (From T)</div>
                        </div>
                    </div>
                    
                    <div id="freqChart" class="grid grid-cols-[repeat(26,minmax(0,1fr))] gap-1 h-40 items-end pb-6 border-b border-gray-700">
                        <!-- Bars generated by JS -->
                    </div>
                    <!-- Labels -->
                    <div class="grid grid-cols-[repeat(26,minmax(0,1fr))] gap-1 mt-2 text-center">
                        <!-- Labels generated by JS -->
                    </div>
                </div>

            </div>
        </div>

        <!-- Right Panel: Code -->
        <div class="lg:w-[600px] bg-[#1e1e1e] overflow-auto custom-scroll border-l border-gray-800 flex flex-col">
            <div class="sticky top-0 bg-[#1e1e1e] border-b border-gray-800 px-4 py-2 flex justify-between items-center z-10">
                <span class="text-xs font-bold text-gray-500 uppercase">Solution.java</span>
            </div>
            <div class="p-4 text-sm leading-6">
<pre><code class="language-java text-gray-300">
<span id="line-1" class="block pl-2 border-l-4 border-transparent">class Solution {</span>
<span id="line-2" class="block pl-2 border-l-4 border-transparent">    public boolean isAnagram(String s, String t) {</span>
<span id="line-3" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-4" class="block pl-2 border-l-4 border-transparent">        <span class="text-gray-500">// Check if lengths differ</span></span>
<span id="line-5" class="block pl-2 border-l-4 border-transparent">        if (s.length() != t.length()) {</span>
<span id="line-6" class="block pl-2 border-l-4 border-transparent">            return false;</span>
<span id="line-7" class="block pl-2 border-l-4 border-transparent">        }</span>
<span id="line-8" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-9" class="block pl-2 border-l-4 border-transparent">        <span class="text-gray-500">// Create an array of size 26</span></span>
<span id="line-10" class="block pl-2 border-l-4 border-transparent">        int[] count = new int[26];</span>
<span id="line-11" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-12" class="block pl-2 border-l-4 border-transparent">        <span class="text-gray-500">// Loop over string s to increment</span></span>
<span id="line-13" class="block pl-2 border-l-4 border-transparent">        for (int i = 0; i < s.length(); i++) {</span>
<span id="line-14" class="block pl-2 border-l-4 border-transparent">            char c = s.charAt(i);</span>
<span id="line-15" class="block pl-2 border-l-4 border-transparent">            count[c - 'a']++; </span>
<span id="line-16" class="block pl-2 border-l-4 border-transparent">        }</span>
<span id="line-17" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-18" class="block pl-2 border-l-4 border-transparent">        <span class="text-gray-500">// Loop over string t to decrement</span></span>
<span id="line-19" class="block pl-2 border-l-4 border-transparent">        for (int i = 0; i < t.length(); i++) {</span>
<span id="line-20" class="block pl-2 border-l-4 border-transparent">            char c = t.charAt(i);</span>
<span id="line-21" class="block pl-2 border-l-4 border-transparent">            count[c - 'a']--; </span>
<span id="line-22" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-23" class="block pl-2 border-l-4 border-transparent">            <span class="text-gray-500">// If count becomes negative</span></span>
<span id="line-24" class="block pl-2 border-l-4 border-transparent">            if (count[c - 'a'] < 0) {</span>
<span id="line-25" class="block pl-2 border-l-4 border-transparent">                return false;</span>
<span id="line-26" class="block pl-2 border-l-4 border-transparent">            }</span>
<span id="line-27" class="block pl-2 border-l-4 border-transparent">        }</span>
<span id="line-28" class="block pl-2 border-l-4 border-transparent"></span>
<span id="line-29" class="block pl-2 border-l-4 border-transparent">        <span class="text-gray-500">// Strings are exact anagrams</span></span>
<span id="line-30" class="block pl-2 border-l-4 border-transparent">        return true;</span>
<span id="line-31" class="block pl-2 border-l-4 border-transparent">    }</span>
<span id="line-32" class="block pl-2 border-l-4 border-transparent">}</span>
</code></pre>
            </div>
        </div>
    </main>

    <script>
        // --- State ---
        let isRunning = false;
        let controller = null;
        let currentHighlight = null;
        
        // --- DOM Elements ---
        const els = {
            sInput: document.getElementById('inputS'),
            tInput: document.getElementById('inputT'),
            containerS: document.getElementById('containerS'),
            containerT: document.getElementById('containerT'),
            freqChart: document.getElementById('freqChart'),
            freqLabels: document.querySelector('#freqChart + div'),
            statusText: document.getElementById('statusText'),
            statusBadge: document.getElementById('statusBadge'),
            btnStart: document.getElementById('btnStart'),
            btnReset: document.getElementById('btnReset'),
            speedRange: document.getElementById('speedRange'),
            pointerS: document.getElementById('pointerS'),
            pointerT: document.getElementById('pointerT'),
            valI: document.getElementById('valI'),
            valJ: document.getElementById('valJ'),
        };

        // --- Initialization ---
        function initChart() {
            els.freqChart.innerHTML = '';
            els.freqLabels.innerHTML = '';
            const aCode = 'a'.charCodeAt(0);
            
            for (let i = 0; i < 26; i++) {
                const char = String.fromCharCode(aCode + i);
                
                // Bar container
                const barContainer = document.createElement('div');
                barContainer.className = 'count-bar-container relative group';
                
                // The actual colored bar
                const bar = document.createElement('div');
                bar.id = `bar-${i}`;
                bar.className = 'count-bar bg-gray-700 w-3/4 mx-auto';
                bar.style.height = '4px'; // Base height
                
                // Value badge floating above
                const val = document.createElement('span');
                val.id = `val-${i}`;
                val.className = 'absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-mono text-gray-400 opacity-0 transition-opacity';
                val.textContent = '0';
                
                barContainer.appendChild(val);
                barContainer.appendChild(bar);
                els.freqChart.appendChild(barContainer);

                // Label below
                const label = document.createElement('div');
                label.className = 'text-[10px] font-mono text-gray-500 uppercase';
                label.textContent = char;
                els.freqLabels.appendChild(label);
            }
        }
        
        initChart();

        function createCharBox(char, idPrefix, index) {
            const div = document.createElement('div');
            div.id = `${idPrefix}-${index}`;
            div.className = 'vis-box w-10 h-10 border border-gray-700 rounded bg-gray-800 flex items-center justify-center font-mono text-lg font-bold text-gray-300';
            div.textContent = char;
            return div;
        }

        // --- Utils ---
        const sleep = (ms) => new Promise(r => setTimeout(r, ms));
        const getDelay = () => {
            const val = 101 - parseInt(els.speedRange.value); 
            // Range 1-100. 
            // 100 -> 1ms (fastest)
            // 1 -> 1000ms (slowest)
            // Linear mapping roughly:
            return val * 15; 
        };

        function highlightLine(lineNum) {
            if (currentHighlight) {
                document.getElementById(`line-${currentHighlight}`).classList.remove('highlight-line');
            }
            if (lineNum) {
                const line = document.getElementById(`line-${lineNum}`);
                if (line) {
                    line.classList.add('highlight-line');
                    line.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    currentHighlight = lineNum;
                }
            }
        }

        function setStatus(text, type = 'default') {
            els.statusText.textContent = text;
            if (type === 'success') {
                els.statusBadge.textContent = 'TRUE';
                els.statusBadge.className = 'bg-green-500/20 text-green-400 border border-green-500/50 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide inline-block';
                els.statusBadge.classList.remove('hidden');
            } else if (type === 'error') {
                els.statusBadge.textContent = 'FALSE';
                els.statusBadge.className = 'bg-red-500/20 text-red-400 border border-red-500/50 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide inline-block';
                els.statusBadge.classList.remove('hidden');
            } else {
                els.statusBadge.classList.add('hidden');
            }
        }

        function updateFreqBar(index, count, isInc) {
            const bar = document.getElementById(`bar-${index}`);
            const val = document.getElementById(`val-${index}`);
            
            val.textContent = count;
            val.style.opacity = count === 0 ? '0' : '1';
            
            // Visual height calculation (cap at some max)
            const height = Math.min(Math.abs(count) * 15 + 4, 80); 
            bar.style.height = `${height}px`;
            
            if (count > 0) {
                bar.className = 'count-bar bg-blue-500 w-3/4 mx-auto';
                val.className = 'absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-mono text-blue-400 font-bold transition-opacity';
            } else if (count < 0) {
                bar.className = 'count-bar bg-red-500 w-3/4 mx-auto';
                val.className = 'absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-mono text-red-400 font-bold transition-opacity';
            } else {
                bar.className = 'count-bar bg-gray-600 w-3/4 mx-auto';
                val.className = 'absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] font-mono text-gray-400 opacity-0 transition-opacity';
            }
        }

        function highlightChar(prefix, index, state) {
            // clear previous
            document.querySelectorAll(`[id^="${prefix}-"]`).forEach(el => {
                el.classList.remove('highlight-current', 'highlight-match', 'highlight-error', 'border-blue-500', 'text-white');
            });
            
            if (index === null) return;

            const el = document.getElementById(`${prefix}-${index}`);
            if (!el) return;

            if (state === 'active') {
                el.classList.add('highlight-current', 'border-blue-500', 'text-white');
            } else if (state === 'processed') {
                // subtle
            }
        }

        // --- Core Algorithm Generator ---
        async function* runAlgorithm(s, t) {
            highlightLine(2);
            setStatus("Starting algorithm...");
            yield;

            // Step 1: Length Check
            highlightLine(5);
            setStatus(`Checking lengths: s.length=${s.length}, t.length=${t.length}`);
            yield;

            if (s.length !== t.length) {
                highlightLine(6);
                setStatus("Lengths differ. Returning false.", 'error');
                yield;
                return false;
            }

            // Step 2: Init Array
            highlightLine(10);
            setStatus("Initializing frequency array [26] with zeros.");
            yield;

            const count = new Array(26).fill(0);

            // Step 3: Loop S
            els.pointerS.style.opacity = '1';
            for (let i = 0; i < s.length; i++) {
                els.valI.textContent = i;
                highlightLine(13);
                highlightChar('s', i, 'active');
                setStatus(`Loop S: index i=${i}`);
                yield;

                highlightLine(14);
                const char = s[i];
                const charCode = char.charCodeAt(0) - 97; // 'a' is 97
                setStatus(`Reading s[${i}] = '${char}'`);
                yield;

                highlightLine(15);
                count[charCode]++;
                updateFreqBar(charCode, count[charCode], true);
                setStatus(`Incrementing count for '${char}': ${count[charCode] - 1} -> ${count[charCode]}`);
                yield;
            }
            // Cleanup Loop S visual
            els.pointerS.style.opacity = '0';
            highlightChar('s', null);

            // Step 4: Loop T
            els.pointerT.style.opacity = '1';
            for (let i = 0; i < t.length; i++) {
                els.valJ.textContent = i;
                highlightLine(19);
                highlightChar('t', i, 'active');
                setStatus(`Loop T: index i=${i}`);
                yield;

                highlightLine(20);
                const char = t[i];
                const charCode = char.charCodeAt(0) - 97;
                setStatus(`Reading t[${i}] = '${char}'`);
                yield;

                highlightLine(21);
                count[charCode]--;
                updateFreqBar(charCode, count[charCode], false);
                setStatus(`Decrementing count for '${char}': ${count[charCode] + 1} -> ${count[charCode]}`);
                yield;

                highlightLine(24);
                if (count[charCode] < 0) {
                    setStatus(`Check: count['${char}'] is negative (${count[charCode]}).`, 'error');
                    highlightLine(25);
                    yield;
                    return false;
                }
            }

            // Cleanup Loop T visual
            els.pointerT.style.opacity = '0';
            highlightChar('t', null);
            
            // Step 5: Success
            highlightLine(30);
            setStatus("Loop finished without negative counts. Strings are anagrams!", 'success');
            yield;
            return true;
        }

        // --- Controller ---
        async function startVisualization() {
            if (isRunning) return;
            
            const s = els.sInput.value.toLowerCase().replace(/[^a-z]/g, '');
            const t = els.tInput.value.toLowerCase().replace(/[^a-z]/g, '');
            
            // Update inputs with cleaned values
            els.sInput.value = s;
            els.tInput.value = t;

            // Reset UI
            resetUI(s, t);
            
            isRunning = true;
            els.btnStart.disabled = true;
            els.btnReset.disabled = false;
            els.sInput.disabled = true;
            els.tInput.disabled = true;

            const iterator = runAlgorithm(s, t);
            
            while (isRunning) {
                const { value, done } = await iterator.next();
                if (done) {
                    isRunning = false;
                    break;
                }
                await sleep(getDelay());
            }
            
            els.btnStart.disabled = false;
            els.sInput.disabled = false;
            els.tInput.disabled = false;
        }

        function resetVisualization() {
            isRunning = false; // Breaks the loop in startVisualization
            highlightLine(null);
            setStatus("Ready to start...");
            els.statusBadge.classList.add('hidden');
            
            els.pointerS.style.opacity = '0';
            els.pointerT.style.opacity = '0';
            
            // Wait a tiny bit for the async loop to die if it was running
            setTimeout(() => {
                const s = els.sInput.value;
                const t = els.tInput.value;
                resetUI(s, t);
                els.btnStart.disabled = false;
                els.btnReset.disabled = true;
                els.sInput.disabled = false;
                els.tInput.disabled = false;
            }, 100);
        }

        function resetUI(s, t) {
            // Clear boxes
            els.containerS.innerHTML = '';
            els.containerT.innerHTML = '';
            
            // Fill boxes S
            s.split('').forEach((char, i) => {
                els.containerS.appendChild(createCharBox(char, 's', i));
            });
            // Fill boxes T
            t.split('').forEach((char, i) => {
                els.containerT.appendChild(createCharBox(char, 't', i));
            });

            // Reset Chart
            initChart();
            
            // Reset Highlights
            highlightLine(null);
            setStatus("Ready to start...");
            els.statusBadge.classList.add('hidden');
        }

        // Initial render
        resetUI(els.sInput.value, els.tInput.value);

    </script>
</body>
</html>